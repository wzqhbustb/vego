📊 最核心的 5 个测试（按重要性排序）
1️⃣ BenchmarkHNSW_E2E_10K_D128 ⭐⭐⭐⭐⭐
为什么最重要：

✅ 代表典型中小规模应用（10K vectors）
✅ 128维是常见的轻量级 embedding 维度
✅ 默认参数配置，反映开箱即用性能
✅ 测试时间适中（~5分钟）
✅ 可作为性能回归的 baseline
关键指标：

Build QPS: ~400-500 vectors/sec
Query P99: <1ms
Recall@10: >95%


2️⃣ BenchmarkHNSW_E2E_100K_D128 ⭐⭐⭐⭐⭐
为什么重要：

✅ 验证大规模性能（100K = 实际生产场景）
✅ 暴露算法复杂度问题（与 10K 对比）
✅ 测试内存管理（~360MB 内存）
✅ Ground Truth 并行优化效果明显
预期性能变化：
10K  → 100K (10x 数据)
-------------------------------
Build:    25s → 350s  (~14x, 接近 O(N*logN))
Query P99: 750µs → 1.2ms (~1.6x, 符合 O(logN))
Memory:   35MB → 360MB (~10x, 线性增长)


3️⃣ BenchmarkHNSW_E2E_10K_D1536 ⭐⭐⭐⭐
为什么重要：

✅ OpenAI text-embedding-3 维度（1536）
✅ 验证高维向量性能
✅ 距离计算成为瓶颈（优化方向）
预期性能：
D128 → D1536 (12x 维度)
-------------------------------
Distance Calc: 12x 慢（主导因素）
Query P99:    ~3-4ms (vs 750µs)
Memory:       12x 增长
优化潜力最大：SIMD 加速可提升 4-8x


4️⃣ BenchmarkHNSW_E2E_10K_D128_Concurrent ⭐⭐⭐⭐
为什么重要：

✅ 验证多核扩展性（生产环境必需）
✅ 发现锁竞争问题
✅ 评估实际吞吐量上限

理想扩展性：

Cores | QPS    | Scaling
------|--------|--------
1     | 3,300  | 1.0x
2     | 6,200  | 1.9x  ✅
4     | 11,000 | 3.3x  ⚠️ (开始有锁竞争)
8     | 18,000 | 5.5x  ⚠️
16    | 25,000 | 7.6x  ⚠️ (严重锁竞争)

如果扩展性差 < 0.7x，说明需要优化锁



5️⃣ BenchmarkHNSW_E2E_10K_Ef50 vs Ef200 vs Ef400 ⭐⭐⭐⭐
为什么重要：

✅ 揭示延迟-召回率权衡（最实用）
✅ 指导用户参数配置
✅ 验证算法正确性（Ef↑ → Recall↑）
预期结果：

Ef    | P99 Latency | Recall@10 | 推荐场景
------|-------------|-----------|----------
50    | 400µs       | 92-94%    | 低延迟优先
100   | 750µs       | 96-98%    | 平衡（默认）
200   | 1.2ms       | 98-99%    | 高召回
400   | 2.0ms       | 99.5%     | 准确性优先


🔧 其他测试的价值评估
可选但有价值
测试	重要性	价值
BenchmarkHNSW_E2E_10K_M8/32/64	⭐⭐⭐	指导内存-性能权衡
BenchmarkHNSW_E2E_10K_Cosine	⭐⭐⭐	验证距离函数正确性
BenchmarkHNSW_E2E_10K_D768	⭐⭐⭐	BERT embedding 常见维度
BenchmarkHNSW_E2E_10K_Top1/50/100	⭐⭐	TopK 影响较小
BenchmarkHNSW_E2E_1K_D128	⭐⭐	仅快速烟雾测试
优先级较低
10K_D256/D512：介于 D128 和 D768 之间，可省略
10K_InnerProduct：与 Cosine 类似
Top1/Top50/Top100：TopK 对性能影响很小



Running tool: /opt/homebrew/bin/go test -test.fullpath=true -benchmem -run=^$ -bench ^BenchmarkHNSW_E2E_10K_D128$ github.com/wzqhbustb/vego/index

goos: darwin
goarch: arm64
pkg: github.com/wzqhbustb/vego/index
cpu: Apple M3 Max
=== RUN   BenchmarkHNSW_E2E_10K_D128
BenchmarkHNSW_E2E_10K_D128
    /Users/wangyang/vego/index/benchmark_test.go:435: Generating 10000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:435: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:435: Build completed in 37.44924275s (267.03 vectors/sec, 15.78 MB memory, 110447.42 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:435: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:435: Save completed in 20.140917ms (5.79 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:435: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:435: Load completed in 15.618708ms
    /Users/wangyang/vego/index/benchmark_test.go:435: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:435: Ground truth computed in 16.418709ms
    /Users/wangyang/vego/index/benchmark_test.go:435: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:435: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 100/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 200/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 300/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 400/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 500/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 600/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 700/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 800/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 900/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435:   Completed 1000/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:435: Query completed: 1422.88 qps, Recall@10: 0.8250 (82.50%)
    /Users/wangyang/vego/index/benchmark_test.go:435: Latency - Avg: 702.801µs, P50: 669.667µs, P95: 953.125µs, P99: 1.124417ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2

Build Performance:
  Time:             37.44924275s
  Throughput:       267.03 vectors/sec
  Memory Usage:     15.78 MB (110447.42 MB total alloc)

Persistence Performance:
  Save Time:        20.140917ms
  Load Time:        15.618708ms
  Storage Size:     5.79 MB
  Compression:      0.84x

Query Performance:
  Total Time:       702.801042ms
  Throughput:       1422.88 queries/sec
  Avg Latency:      702.801µs
  P50 Latency:      669.667µs
  P95 Latency:      953.125µs
  P99 Latency:      1.124417ms
  P99/P50 Ratio:    1.68x
  Recall@10:        0.8250 (82.50%)
================================================================================
BenchmarkHNSW_E2E_10K_D128-16                  1        38244580791 ns/op       117616744904 B/op       241179137 allocs/op
PASS
ok      github.com/wzqhbustb/vego/index 38.757s



Running tool: /opt/homebrew/bin/go test -test.fullpath=true -benchmem -run=^$ -bench ^BenchmarkHNSW_E2E_100K_D128$ github.com/wzqhbustb/vego/index

goos: darwin
goarch: arm64
pkg: github.com/wzqhbustb/vego/index
cpu: Apple M3 Max
=== RUN   BenchmarkHNSW_E2E_100K_D128
BenchmarkHNSW_E2E_100K_D128
    /Users/wangyang/vego/index/benchmark_test.go:455: Generating 100000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:455: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 1000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 2000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 3000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 4000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 5000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 6000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 7000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 8000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 9000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 10000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 11000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 12000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 13000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 14000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 15000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 16000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 17000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 18000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 19000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 20000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 21000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 22000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 23000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 24000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 25000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 26000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 27000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 28000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 29000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 30000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 31000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 32000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 33000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 34000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 35000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 36000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 37000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 38000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 39000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 40000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 41000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 42000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 43000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 44000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 45000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 46000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 47000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 48000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 49000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 50000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 51000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 52000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 53000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 54000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 55000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 56000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 57000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 58000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 59000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 60000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 61000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 62000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 63000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 64000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 65000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 66000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 67000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 68000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 69000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 70000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 71000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 72000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 73000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 74000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 75000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 76000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 77000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 78000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 79000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 80000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 81000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 82000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 83000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 84000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 85000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 86000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 87000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 88000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 89000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 90000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 91000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 92000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 93000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 94000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 95000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 96000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 97000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 98000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 99000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Added 100000/100000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:455: Build completed in 8m34.8518645s (194.23 vectors/sec, 103.80 MB memory, 1289611.02 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:455: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:455: Save completed in 181.198375ms (63.39 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:455: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:455: Load completed in 148.99275ms
    /Users/wangyang/vego/index/benchmark_test.go:455: Computing ground truth for 50 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:455: Ground truth computed in 97.646625ms
    /Users/wangyang/vego/index/benchmark_test.go:455: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:455: Warming up with 50 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 100/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 200/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 300/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 400/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 500/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 600/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 700/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 800/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 900/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455:   Completed 1000/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:455: Query completed: 782.39 qps, Recall@10: 0.3820 (38.20%)
    /Users/wangyang/vego/index/benchmark_test.go:455: Latency - Avg: 1.278133ms, P50: 1.233166ms, P95: 1.598ms, P99: 2.392833ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     100000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2

Build Performance:
  Time:             8m34.8518645s
  Throughput:       194.23 vectors/sec
  Memory Usage:     103.80 MB (1289611.02 MB total alloc)

Persistence Performance:
  Save Time:        181.198375ms
  Load Time:        148.99275ms
  Storage Size:     63.39 MB
  Compression:      0.77x

Query Performance:
  Total Time:       1.278133459s
  Throughput:       782.39 queries/sec
  Avg Latency:      1.278133ms
  P50 Latency:      1.233166ms
  P95 Latency:      1.598ms
  P99 Latency:      2.392833ms
  P99/P50 Ratio:    1.94x
  Recall@10:        0.3820 (38.20%)
================================================================================
BenchmarkHNSW_E2E_100K_D128-16                 1        516743637042 ns/op      1356019781080 B/op      2780766271 allocs/op
PASS
ok      github.com/wzqhbustb/vego/index 517.264s



Running tool: /opt/homebrew/bin/go test -test.fullpath=true -benchmem -run=^$ -bench ^BenchmarkHNSW_E2E_10K_D1536$ github.com/wzqhbustb/vego/index

goos: darwin
goarch: arm64
pkg: github.com/wzqhbustb/vego/index
cpu: Apple M3 Max
=== RUN   BenchmarkHNSW_E2E_10K_D1536
BenchmarkHNSW_E2E_10K_D1536
    /Users/wangyang/vego/index/benchmark_test.go:548: Generating 10000 vectors of dimension 1536...
    /Users/wangyang/vego/index/benchmark_test.go:548: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:548: Build completed in 6m32.362408666s (25.49 vectors/sec, 85.91 MB memory, 1322220.63 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:548: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:548: Save completed in 93.243958ms (59.51 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:548: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:548: Load completed in 68.855459ms
    /Users/wangyang/vego/index/benchmark_test.go:548: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:548: Ground truth computed in 127.361042ms
    /Users/wangyang/vego/index/benchmark_test.go:548: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:548: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 100/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 200/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 300/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 400/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 500/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 600/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 700/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 800/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 900/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548:   Completed 1000/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:548: Query completed: 151.31 qps, Recall@10: 0.4300 (43.00%)
    /Users/wangyang/vego/index/benchmark_test.go:548: Latency - Avg: 6.608872ms, P50: 6.512917ms, P95: 7.699959ms, P99: 8.3535ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        1536
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2

Build Performance:
  Time:             6m32.362408666s
  Throughput:       25.49 vectors/sec
  Memory Usage:     85.91 MB (1322220.63 MB total alloc)

Persistence Performance:
  Save Time:        93.243958ms
  Load Time:        68.855459ms
  Storage Size:     59.51 MB
  Compression:      0.98x

Query Performance:
  Total Time:       6.608872625s
  Throughput:       151.31 queries/sec
  Avg Latency:      6.608872ms
  P50 Latency:      6.512917ms
  P95 Latency:      7.699959ms
  P99 Latency:      8.3535ms
  P99/P50 Ratio:    1.28x
  Recall@10:        0.4300 (43.00%)
================================================================================
BenchmarkHNSW_E2E_10K_D1536-16                 1        399439541459 ns/op      1405922257720 B/op      249914264 allocs/op
PASS
ok      github.com/wzqhbustb/vego/index 399.654s



Running tool: /opt/homebrew/bin/go test -test.fullpath=true -benchmem -run=^$ -bench ^BenchmarkHNSW_E2E_10K_D128_Concurrent$ github.com/wzqhbustb/vego/index

goos: darwin
goarch: arm64
pkg: github.com/wzqhbustb/vego/index
cpu: Apple M3 Max
=== RUN   BenchmarkHNSW_E2E_10K_D128_Concurrent
BenchmarkHNSW_E2E_10K_D128_Concurrent
=== RUN   BenchmarkHNSW_E2E_10K_D128_Concurrent/C1
BenchmarkHNSW_E2E_10K_D128_Concurrent/C1
    /Users/wangyang/vego/index/benchmark_test.go:477: Generating 10000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:477: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477: Build completed in 38.546778458s (259.43 vectors/sec, 19.15 MB memory, 110447.21 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:477: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Save completed in 22.449625ms (5.79 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:477: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Load completed in 16.268125ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:477: Ground truth computed in 17.725375ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:477: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 100/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 200/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 300/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 400/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 500/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 600/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 700/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 800/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 900/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Completed 1000/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477: Query completed: 1300.19 qps, Recall@10: 0.8250 (82.50%)
    /Users/wangyang/vego/index/benchmark_test.go:477: Latency - Avg: 769.115µs, P50: 733.916µs, P95: 1.077375ms, P99: 1.321875ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2

Build Performance:
  Time:             38.546778458s
  Throughput:       259.43 vectors/sec
  Memory Usage:     19.15 MB (110447.21 MB total alloc)

Persistence Performance:
  Save Time:        22.449625ms
  Load Time:        16.268125ms
  Storage Size:     5.79 MB
  Compression:      0.84x

Query Performance:
  Total Time:       769.115542ms
  Throughput:       1300.19 queries/sec
  Avg Latency:      769.115µs
  P50 Latency:      733.916µs
  P95 Latency:      1.077375ms
  P99 Latency:      1.321875ms
  P99/P50 Ratio:    1.80x
  Recall@10:        0.8250 (82.50%)
================================================================================
BenchmarkHNSW_E2E_10K_D128_Concurrent/C1-16            1        39414091083 ns/op       117616527448 B/op       241179224 allocs/op
=== RUN   BenchmarkHNSW_E2E_10K_D128_Concurrent/C2
BenchmarkHNSW_E2E_10K_D128_Concurrent/C2
    /Users/wangyang/vego/index/benchmark_test.go:477: Generating 10000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:477: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477: Build completed in 39.984166667s (250.10 vectors/sec, 23.53 MB memory, 110445.90 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:477: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Save completed in 18.93425ms (5.79 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:477: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Load completed in 15.273125ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:477: Ground truth computed in 15.614916ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:477: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477: Running concurrent queries with 2 workers...
    /Users/wangyang/vego/index/benchmark_test.go:477: Query completed: 2550.22 qps, Recall@10: 0.8250 (82.50%)
    /Users/wangyang/vego/index/benchmark_test.go:477: Latency - Avg: 392.122µs, P50: 721.542µs, P95: 1.147ms, P99: 1.259125ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2
  Concurrency:      2

Build Performance:
  Time:             39.984166667s
  Throughput:       250.10 vectors/sec
  Memory Usage:     23.53 MB (110445.90 MB total alloc)

Persistence Performance:
  Save Time:        18.93425ms
  Load Time:        15.273125ms
  Storage Size:     5.79 MB
  Compression:      0.84x

Query Performance:
  Total Time:       392.122917ms
  Throughput:       2550.22 queries/sec
  Per-Thread QPS:   1275.11 queries/sec
  Avg Latency:      392.122µs
  P50 Latency:      721.542µs
  P95 Latency:      1.147ms
  P99 Latency:      1.259125ms
  P99/P50 Ratio:    1.75x
  Recall@10:        0.8250 (82.50%)
================================================================================
BenchmarkHNSW_E2E_10K_D128_Concurrent/C2-16            1        40466720208 ns/op       117615094328 B/op       241178671 allocs/op
=== RUN   BenchmarkHNSW_E2E_10K_D128_Concurrent/C4
BenchmarkHNSW_E2E_10K_D128_Concurrent/C4
    /Users/wangyang/vego/index/benchmark_test.go:477: Generating 10000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:477: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477: Build completed in 40.242236792s (248.50 vectors/sec, 18.30 MB memory, 110446.65 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:477: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Save completed in 23.784ms (5.79 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:477: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Load completed in 15.981083ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:477: Ground truth computed in 20.084ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:477: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477: Running concurrent queries with 4 workers...
    /Users/wangyang/vego/index/benchmark_test.go:477: Query completed: 4390.52 qps, Recall@10: 0.8250 (82.50%)
    /Users/wangyang/vego/index/benchmark_test.go:477: Latency - Avg: 227.763µs, P50: 814.958µs, P95: 1.368792ms, P99: 1.50925ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2
  Concurrency:      4

Build Performance:
  Time:             40.242236792s
  Throughput:       248.50 vectors/sec
  Memory Usage:     18.30 MB (110446.65 MB total alloc)

Persistence Performance:
  Save Time:        23.784ms
  Load Time:        15.981083ms
  Storage Size:     5.79 MB
  Compression:      0.84x

Query Performance:
  Total Time:       227.763584ms
  Throughput:       4390.52 queries/sec
  Per-Thread QPS:   1097.63 queries/sec
  Avg Latency:      227.763µs
  P50 Latency:      814.958µs
  P95 Latency:      1.368792ms
  P99 Latency:      1.50925ms
  P99/P50 Ratio:    1.85x
  Recall@10:        0.8250 (82.50%)
================================================================================
BenchmarkHNSW_E2E_10K_D128_Concurrent/C4-16            1        40569873042 ns/op       117615889256 B/op       241178581 allocs/op
=== RUN   BenchmarkHNSW_E2E_10K_D128_Concurrent/C8
BenchmarkHNSW_E2E_10K_D128_Concurrent/C8
    /Users/wangyang/vego/index/benchmark_test.go:477: Generating 10000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:477: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477: Build completed in 39.847416875s (250.96 vectors/sec, 16.45 MB memory, 110446.06 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:477: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Save completed in 21.006166ms (5.79 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:477: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Load completed in 16.702167ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:477: Ground truth computed in 16.615167ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:477: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477: Running concurrent queries with 8 workers...
    /Users/wangyang/vego/index/benchmark_test.go:477: Query completed: 5914.88 qps, Recall@10: 0.8250 (82.50%)
    /Users/wangyang/vego/index/benchmark_test.go:477: Latency - Avg: 169.065µs, P50: 1.3025ms, P95: 1.82275ms, P99: 1.964125ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2
  Concurrency:      8

Build Performance:
  Time:             39.847416875s
  Throughput:       250.96 vectors/sec
  Memory Usage:     16.45 MB (110446.06 MB total alloc)

Persistence Performance:
  Save Time:        21.006166ms
  Load Time:        16.702167ms
  Storage Size:     5.79 MB
  Compression:      0.84x

Query Performance:
  Total Time:       169.065209ms
  Throughput:       5914.88 queries/sec
  Per-Thread QPS:   739.36 queries/sec
  Avg Latency:      169.065µs
  P50 Latency:      1.3025ms
  P95 Latency:      1.82275ms
  P99 Latency:      1.964125ms
  P99/P50 Ratio:    1.51x
  Recall@10:        0.8250 (82.50%)
================================================================================
BenchmarkHNSW_E2E_10K_D128_Concurrent/C8-16            1        40112377709 ns/op       117615274160 B/op       241178588 allocs/op
=== RUN   BenchmarkHNSW_E2E_10K_D128_Concurrent/C16
BenchmarkHNSW_E2E_10K_D128_Concurrent/C16
    /Users/wangyang/vego/index/benchmark_test.go:477: Generating 10000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:477: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:477: Build completed in 38.965646s (256.64 vectors/sec, 12.92 MB memory, 110446.32 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:477: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Save completed in 18.793459ms (5.79 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:477: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:477: Load completed in 15.081333ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:477: Ground truth computed in 16.576375ms
    /Users/wangyang/vego/index/benchmark_test.go:477: Running 1000 queries with ef=100, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:477: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:477: Running concurrent queries with 16 workers...
    /Users/wangyang/vego/index/benchmark_test.go:477: Query completed: 4240.36 qps, Recall@10: 0.8250 (82.50%)
    /Users/wangyang/vego/index/benchmark_test.go:477: Latency - Avg: 235.829µs, P50: 3.178959ms, P95: 7.516958ms, P99: 13.462125ms

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         100
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2
  Concurrency:      16

Build Performance:
  Time:             38.965646s
  Throughput:       256.64 vectors/sec
  Memory Usage:     12.92 MB (110446.32 MB total alloc)

Persistence Performance:
  Save Time:        18.793459ms
  Load Time:        15.081333ms
  Storage Size:     5.79 MB
  Compression:      0.84x

Query Performance:
  Total Time:       235.82925ms
  Throughput:       4240.36 queries/sec
  Per-Thread QPS:   265.02 queries/sec
  Avg Latency:      235.829µs
  P50 Latency:      3.178959ms
  P95 Latency:      7.516958ms
  P99 Latency:      13.462125ms
  P99/P50 Ratio:    4.23x
  Recall@10:        0.8250 (82.50%)
================================================================================
BenchmarkHNSW_E2E_10K_D128_Concurrent/C16-16                   1        39291707916 ns/op       117615551504 B/op       241178474 allocs/op
PASS
ok      github.com/wzqhbustb/vego/index 200.427s



Running tool: /opt/homebrew/bin/go test -test.fullpath=true -benchmem -run=^$ -bench ^BenchmarkHNSW_E2E_10K_Ef50$ github.com/wzqhbustb/vego/index

goos: darwin
goarch: arm64
pkg: github.com/wzqhbustb/vego/index
cpu: Apple M3 Max
=== RUN   BenchmarkHNSW_E2E_10K_Ef50
BenchmarkHNSW_E2E_10K_Ef50
    /Users/wangyang/vego/index/benchmark_test.go:653: Generating 10000 vectors of dimension 128...
    /Users/wangyang/vego/index/benchmark_test.go:653: Building index with M=16, EfConstruction=200...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 1000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 2000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 3000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 4000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 5000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 6000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 7000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 8000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 9000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Added 10000/10000 vectors...
    /Users/wangyang/vego/index/benchmark_test.go:653: Build completed in 37.619863958s (265.82 vectors/sec, 20.72 MB memory, 110445.62 MB total alloc)
    /Users/wangyang/vego/index/benchmark_test.go:653: Saving index to storage...
    /Users/wangyang/vego/index/benchmark_test.go:653: Save completed in 21.847208ms (5.79 MB on disk)
    /Users/wangyang/vego/index/benchmark_test.go:653: Loading index from storage...
    /Users/wangyang/vego/index/benchmark_test.go:653: Load completed in 16.333834ms
    /Users/wangyang/vego/index/benchmark_test.go:653: Computing ground truth for 100 queries (parallel)...
    /Users/wangyang/vego/index/benchmark_test.go:653: Ground truth computed in 16.825167ms
    /Users/wangyang/vego/index/benchmark_test.go:653: Running 1000 queries with ef=50, k=10...
    /Users/wangyang/vego/index/benchmark_test.go:653: Warming up with 10 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 100/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 200/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 300/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 400/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 500/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 600/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 700/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 800/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 900/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653:   Completed 1000/1000 queries...
    /Users/wangyang/vego/index/benchmark_test.go:653: Query completed: 2408.00 qps, Recall@10: 0.6370 (63.70%)
    /Users/wangyang/vego/index/benchmark_test.go:653: Latency - Avg: 415.283µs, P50: 391.25µs, P95: 584.291µs, P99: 781.292µs

================================================================================
BENCHMARK RESULTS
================================================================================

Configuration:
  Dataset Size:     10000 vectors
  Dimension:        128
  M:                16
  EfConstruction:   200
  Query Ef:         50
  Top-K:            10
  Num Queries:      1000
  Distance Func:    L2

Build Performance:
  Time:             37.619863958s
  Throughput:       265.82 vectors/sec
  Memory Usage:     20.72 MB (110445.62 MB total alloc)

Persistence Performance:
  Save Time:        21.847208ms
  Load Time:        16.333834ms
  Storage Size:     5.79 MB
  Compression:      0.84x

Query Performance:
  Total Time:       415.283083ms
  Throughput:       2408.00 queries/sec
  Avg Latency:      415.283µs
  P50 Latency:      391.25µs
  P95 Latency:      584.291µs
  P99 Latency:      781.292µs
  P99/P50 Ratio:    2.00x
  Recall@10:        0.6370 (63.70%)
================================================================================
BenchmarkHNSW_E2E_10K_Ef50-16                  1        38131926250 ns/op       116956190192 B/op       239662786 allocs/op
PASS
ok      github.com/wzqhbustb/vego/index 38.679s